<?xml version="1.0" encoding="UTF-8"?>
<workflow-process id="1126999418470812" process-version="1" language-version="1.0" released="true" category="PC5" createdBy="admin" creationDate="20090325T024239"><name>ServicePlanAndPlannedItemApprovalWorkflow</name><process-display-name><localized-text><locale language="en">Service Plan And Planned Item Approval Workflow</locale></localized-text></process-display-name><description><localized-text><locale language="en">This is the master approval workflow for when service plan deliveries and individual planned items are submitted for approval.</locale></localized-text></description><enactment-mappings><mapping><source-attribute struct-name="curam.serviceplans.workflow.wfl.struct.CaseIDAndEnactedFromDetails" name="enactedFrom"/><target-attribute wdo-name="PlannedItemApprovalWDO" name="enactedFrom"/></mapping><mapping><source-attribute struct-name="curam.serviceplans.workflow.wfl.struct.CaseIDAndEnactedFromDetails" name="caseID"/><target-attribute wdo-name="PlannedItemApprovalWDO" name="caseID"/></mapping><mapping><source-attribute struct-name="curam.serviceplans.workflow.wfl.struct.PlannedItemIDKeyList" name="key.plannedItemID"/><target-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/></mapping></enactment-mappings><wdos><wdo is-list-wdo="false" initialize-attributes="false"><wdo-name>PlannedItemApprovalWDO</wdo-name><display-name><localized-text><locale language="en">PlannedItemApprovalWDO</locale></localized-text></display-name><description><localized-text><locale language="en">Main WDO object used throughout the workflow.</locale></localized-text></description><attributes><attribute><attribute-name>approvalType</attribute-name><display-name><localized-text><locale language="en">approvalType</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>AW1</initial-value></attribute><attribute><attribute-name>outstandingApprovals</attribute-name><display-name><localized-text><locale language="en">outstandingApprovals</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>false</initial-value></attribute><attribute><attribute-name>userApprovalRejected</attribute-name><display-name><localized-text><locale language="en">userApprovalRejected</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>false</initial-value></attribute><attribute><attribute-name>enactedFrom</attribute-name><display-name><localized-text><locale language="en">enactedFrom</locale></localized-text></display-name><type>STRING</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>caseID</attribute-name><display-name><localized-text><locale language="en">caseID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>approvalResult</attribute-name><display-name><localized-text><locale language="en">approvalResult</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>eventType</attribute-name><display-name><localized-text><locale language="en">eventType</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>NoEvent</initial-value></attribute></attributes></wdo><wdo is-list-wdo="true" initialize-attributes="false"><wdo-name>PlannedItemsWDO</wdo-name><display-name><localized-text><locale language="en">PlannedItemsWDO</locale></localized-text></display-name><description><localized-text><locale language="en">Contains a list of planned item id's and their type that need approving.  Please note that this list may contain 1 or many.</locale></localized-text></description><attributes><attribute><attribute-name>plannedItemID</attribute-name><display-name><localized-text><locale language="en">plannedItemID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute></attributes></wdo><wdo is-list-wdo="false" initialize-attributes="false"><wdo-name>ApprovalConstantsWDO</wdo-name><display-name><localized-text><locale language="en">ApprovalConstantsWDO</locale></localized-text></display-name><attributes><attribute><attribute-name>PREAPPROVAL</attribute-name><display-name><localized-text><locale language="en">PREAPPROVAL</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>AW1</constant-value></attribute><attribute><attribute-name>POSTAPPROVAL</attribute-name><display-name><localized-text><locale language="en">POSTAPPROVAL</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>AW2</constant-value></attribute><attribute><attribute-name>FAILEDPIUSERAPPROVAL</attribute-name><display-name><localized-text><locale language="en">FAILEDPIUSERAPPROVAL</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>ServicePlans.PlannedItemUserApprovalFail</constant-value></attribute><attribute><attribute-name>PASSEDPIUSERAPPROVAL</attribute-name><display-name><localized-text><locale language="en">PASSEDPIUSERAPPROVAL</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>ServicePlans.PlannedItemUserApprovalPass</constant-value></attribute><attribute><attribute-name>TRUE</attribute-name><display-name><localized-text><locale language="en">TRUE</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>true</constant-value></attribute><attribute><attribute-name>FALSE</attribute-name><display-name><localized-text><locale language="en">FALSE</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>false</constant-value></attribute><attribute><attribute-name>ONE</attribute-name><display-name><localized-text><locale language="en">ONE</locale></localized-text></display-name><type>INT16</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>1</constant-value></attribute><attribute><attribute-name>ZERO</attribute-name><display-name><localized-text><locale language="en">ZERO</locale></localized-text></display-name><type>INT16</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>0</constant-value></attribute></attributes></wdo></wdos><activities><start-process-activity id="1"><name><localized-text><locale language="en">Start Process Activity</locale></localized-text></name><description><localized-text><locale language="en">The start process activity</locale></localized-text></description><split type="none"><transition-id idref="1"/></split></start-process-activity><end-process-activity id="2"><name><localized-text><locale language="en">End Process Activity</locale></localized-text></name><description><localized-text><locale language="en">The end process activity</locale></localized-text></description><join type="xor"/></end-process-activity><automatic-activity id="8" category="AC1"><name><localized-text><locale language="en">Check All Pre Approval Criteria Complete</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="8"/><transition-id idref="40"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="checkAllPreApprovalsComplete"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.workflow.wfl.struct.PlannedItemIDKeyList"><field name="key"><struct type="curam.serviceplans.sl.struct.PlannedItemKey"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/></base-type></field></struct></field></struct></formal-parameter></formal-parameters><return><struct><field name="key"><struct><field name="plannedItemID"><base-type><wdo-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/></base-type></field></struct></field><field name="outstandingApprovals"><struct><field name="outstandingApprovals"><base-type><wdo-attribute wdo-name="PlannedItemApprovalWDO" name="outstandingApprovals"/></base-type></field></struct></field></struct></return></bpo-mapping></automatic-activity><automatic-activity id="15" category="AC1"><name><localized-text><locale language="en">Set Approval Type to Post</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="21"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="setApprovalTypeToPost"><return><struct><field name="approvalType"><base-type><wdo-attribute wdo-name="PlannedItemApprovalWDO" name="approvalType"/></base-type></field></struct></return></bpo-mapping></automatic-activity><automatic-activity id="16" category="AC1"><name><localized-text><locale language="en">Update Planned Item Approval Processing Status</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="50"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="setApprovalProcessingStatusToApprovalsComplete"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.workflow.wfl.struct.PlannedItemIDKeyList"><field name="key"><struct type="curam.serviceplans.sl.struct.PlannedItemKey"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/></base-type></field></struct></field></struct></formal-parameter></formal-parameters></bpo-mapping></automatic-activity><subflow-activity id="13" category="AC1"><name><localized-text><locale language="en">Process Planned Item</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="16"/></split><subflow workflow-process="ProcessPlannedItem" synchronous="true"/><input-mappings><mapping><source-attribute wdo-name="PlannedItemsWDO[Context_Loop.loopCount]" name="plannedItemID"/><target-attribute wdo-name="PlannedItemWDO" name="plannedItemID"/></mapping></input-mappings></subflow-activity><subflow-activity id="5" category="AC1"><name><localized-text><locale language="en">Process Pre Approval Criteria</locale></localized-text></name><description><localized-text><locale language="en">Subflow which will process the planned item's pre approval criteria.</locale></localized-text></description><join type="none"/><split type="none"><transition-id idref="3"/></split><subflow workflow-process="ProcessPlannedItemApprovalCriteria" synchronous="false"/><input-mappings><mapping><source-attribute wdo-name="PlannedItemsWDO[Context_Loop.loopCount]" name="plannedItemID"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></mapping><mapping><source-attribute wdo-name="PlannedItemApprovalWDO" name="approvalType"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="approvalType"/></mapping><mapping><source-attribute wdo-name="PlannedItemApprovalWDO" name="caseID"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="caseID"/></mapping><mapping><source-attribute wdo-name="Context_RuntimeInformation" name="enactingUser"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="userName"/></mapping></input-mappings></subflow-activity><subflow-activity id="9" category="AC1"><name><localized-text><locale language="en">Process User Approval Checks</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="28"/><transition-id idref="43"/></split><subflow workflow-process="ProcessUserApprovalChecks" synchronous="true"/><input-mappings><mapping><source-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/><target-attribute wdo-name="PlannedItemListWDO" name="plannedItemID"/></mapping><mapping><source-attribute wdo-name="Context_RuntimeInformation" name="enactingUser"/><target-attribute wdo-name="UserApprovalChecksWDO" name="userName"/></mapping><mapping><source-attribute wdo-name="PlannedItemApprovalWDO" name="caseID"/><target-attribute wdo-name="UserApprovalChecksWDO" name="caseID"/></mapping><mapping><source-attribute wdo-name="PlannedItemApprovalWDO" name="enactedFrom"/><target-attribute wdo-name="UserApprovalChecksWDO" name="enactedFrom"/></mapping></input-mappings><output-mappings><mapping><source-attribute wdo-name="UserApprovalChecksWDO" name="userApprovalRejected"/><target-attribute wdo-name="PlannedItemApprovalWDO" name="userApprovalRejected"/></mapping></output-mappings></subflow-activity><subflow-activity id="14" category="AC1"><name><localized-text><locale language="en">Process Result From Planned Item Processing</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="51"/><transition-id idref="18"/></split><subflow workflow-process="ProcessResultFromPlannedItemProcessing" synchronous="true"/><input-mappings><mapping><source-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/><target-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/></mapping></input-mappings><output-mappings><mapping><source-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/><target-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/></mapping></output-mappings></subflow-activity><subflow-activity id="18" category="AC1"><name><localized-text><locale language="en">Process Post Approval Criteria</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="23"/></split><subflow workflow-process="ProcessPlannedItemApprovalCriteria" synchronous="false"/><input-mappings><mapping><source-attribute wdo-name="PlannedItemsWDO[Context_Loop.loopCount]" name="plannedItemID"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></mapping><mapping><source-attribute wdo-name="PlannedItemApprovalWDO" name="approvalType"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="approvalType"/></mapping><mapping><source-attribute wdo-name="PlannedItemApprovalWDO" name="caseID"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="caseID"/></mapping><mapping><source-attribute wdo-name="Context_RuntimeInformation" name="enactingUser"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="userName"/></mapping></input-mappings></subflow-activity><route-activity id="22" category="AC1"><name><localized-text><locale language="en">Join3</locale></localized-text></name><join type="xor"/><split type="none"><transition-id idref="48"/></split></route-activity><route-activity id="25" category="AC1"><name><localized-text><locale language="en">Join1</locale></localized-text></name><join type="xor"/><split type="none"><transition-id idref="42"/></split></route-activity><route-activity id="26" category="AC1"><name><localized-text><locale language="en">Join2</locale></localized-text></name><join type="xor"/><split type="none"><transition-id idref="52"/></split></route-activity><loop-begin-activity id="3" category="AC1"><name><localized-text><locale language="en">startLoopForProcessingPreApprovalCriteria [Begin]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="2"/></split><loop-type name="do-while"/><condition><expression id="1" data-item-lhs="Context_Loop.loopCount" operation="&lt;" data-item-rhs="PlannedItemsWDO.size()" conjunction="and"/></condition><block-endpoint-ref activity-id="4"/></loop-begin-activity><loop-begin-activity id="6" category="AC1"><name><localized-text><locale language="en">startLoopForCheckPreApprovalComplete [Begin]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="6"/></split><loop-type name="do-while"/><condition><expression id="1" data-item-lhs="PlannedItemApprovalWDO.outstandingApprovals" operation="==" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/></condition><block-endpoint-ref activity-id="7"/></loop-begin-activity><loop-begin-activity id="11" category="AC1"><name><localized-text><locale language="en">startLoopForProcessingPlannedItem [Begin]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="15"/></split><loop-type name="do-while"/><condition><expression id="1" data-item-lhs="Context_Loop.loopCount" operation="&lt;" data-item-rhs="PlannedItemsWDO.size()" conjunction="and"/></condition><block-endpoint-ref activity-id="12"/></loop-begin-activity><loop-begin-activity id="19" category="AC1"><name><localized-text><locale language="en">startLoopForProcessingPostApprovalCriteria [Begin]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="22"/></split><loop-type name="do-while"/><condition><expression id="1" data-item-lhs="Context_Loop.loopCount" operation="&lt;" data-item-rhs="PlannedItemsWDO.size()" conjunction="and"/></condition><block-endpoint-ref activity-id="20"/></loop-begin-activity><loop-end-activity id="4" category="AC1"><name><localized-text><locale language="en">startLoopForProcessingPreApprovalCriteria [End]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="4"/></split><block-endpoint-ref activity-id="3"/></loop-end-activity><loop-end-activity id="7" category="AC1"><name><localized-text><locale language="en">startLoopForCheckPreApprovalComplete [End]</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="49"/><transition-id idref="10"/></split><block-endpoint-ref activity-id="6"/></loop-end-activity><loop-end-activity id="12" category="AC1"><name><localized-text><locale language="en">startLoopForProcessingPlannedItem [End]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="17"/></split><block-endpoint-ref activity-id="11"/></loop-end-activity><loop-end-activity id="20" category="AC1"><name><localized-text><locale language="en">startLoopForProcessingPostApprovalCriteria [End]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="24"/></split><block-endpoint-ref activity-id="19"/></loop-end-activity><event-wait-activity id="17" category="AC1"><name><localized-text><locale language="en">Wait for Pre Approval Results</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="26"/></split><event-wait wait-on-all-events="false"><events><event identifier="1" event-class="ServicePlans" event-type="PlannedItemUserApprovalPass"><event-match-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/><multiple-occurring-event><list-wdo-name>PlannedItemsWDO</list-wdo-name></multiple-occurring-event></event><event identifier="2" event-class="ServicePlans" event-type="PlannedItemUserApprovalFail"><event-match-attribute wdo-name="PlannedItemsWDO" name="plannedItemID"/><multiple-occurring-event><list-wdo-name>PlannedItemsWDO</list-wdo-name></multiple-occurring-event></event></events><event-output-mappings><event-type wdo-name="PlannedItemApprovalWDO" name="eventType"/></event-output-mappings><deadline complete-activity="true"><duration><seconds>180</seconds></duration></deadline></event-wait></event-wait-activity></activities><transitions><transition id="1" from-activity-idref="1" to-activity-idref="3"/><transition id="2" from-activity-idref="3" to-activity-idref="5"/><transition id="3" from-activity-idref="5" to-activity-idref="4"/><transition id="4" from-activity-idref="4" to-activity-idref="6"/><transition id="6" from-activity-idref="6" to-activity-idref="8"/><transition id="8" from-activity-idref="8" to-activity-idref="17"><condition><expression id="1" data-item-lhs="PlannedItemApprovalWDO.outstandingApprovals" operation="==" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/></condition></transition><transition id="10" from-activity-idref="7" to-activity-idref="9"/><transition id="15" from-activity-idref="11" to-activity-idref="13"/><transition id="16" from-activity-idref="13" to-activity-idref="12"/><transition id="17" from-activity-idref="12" to-activity-idref="14"/><transition id="18" from-activity-idref="14" to-activity-idref="15"/><transition id="21" from-activity-idref="15" to-activity-idref="19"/><transition id="22" from-activity-idref="19" to-activity-idref="18"/><transition id="23" from-activity-idref="18" to-activity-idref="20"/><transition id="24" from-activity-idref="20" to-activity-idref="16"/><transition id="26" from-activity-idref="17" to-activity-idref="25"/><transition id="28" from-activity-idref="9" to-activity-idref="22"><condition><expression id="1" data-item-lhs="PlannedItemApprovalWDO.userApprovalRejected" operation="==" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/></condition></transition><transition id="40" from-activity-idref="8" to-activity-idref="25"/><transition id="42" from-activity-idref="25" to-activity-idref="7"/><transition id="43" from-activity-idref="9" to-activity-idref="11"/><transition id="48" from-activity-idref="22" to-activity-idref="2"/><transition id="49" from-activity-idref="7" to-activity-idref="2"><condition><expression id="1" data-item-lhs="PlannedItemsWDO.size()" operation="==" data-item-rhs="ApprovalConstantsWDO.ZERO" conjunction="or"/></condition></transition><transition id="50" from-activity-idref="16" to-activity-idref="26"/><transition id="51" from-activity-idref="14" to-activity-idref="26"><condition><expression id="1" data-item-lhs="PlannedItemsWDO.size()" operation="==" data-item-rhs="ApprovalConstantsWDO.ZERO" conjunction="and"/></condition></transition><transition id="52" from-activity-idref="26" to-activity-idref="22"/></transitions></workflow-process>