<?xml version="1.0" encoding="UTF-8"?>
<workflow-process id="1126999418470775" process-version="1" language-version="1.0" released="true" category="PC5" createdBy="admin" creationDate="20090429T102326"><name>ProcessPlannedItemApprovalCriteria</name><process-display-name><localized-text><locale language="en">Process Planned Item Approval Criteria</locale></localized-text></process-display-name><description><localized-text><locale language="en">Workflow for processing a planned item's approval criteria.</locale></localized-text></description><enactment-mappings><mapping><source-attribute struct-name="curam.serviceplans.workflow.wfl.struct.ApprovalCriteriaDetails" name="plannedItemID"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></mapping><mapping><source-attribute struct-name="curam.serviceplans.workflow.wfl.struct.ApprovalCriteriaDetails" name="approvalType"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="approvalType"/></mapping><mapping><source-attribute struct-name="curam.serviceplans.workflow.wfl.struct.ApprovalCriteriaDetails" name="caseID"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="caseID"/></mapping><mapping><source-attribute struct-name="curam.serviceplans.workflow.wfl.struct.ApprovalCriteriaDetails" name="userName"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="userName"/></mapping></enactment-mappings><wdos><wdo is-list-wdo="false" initialize-attributes="false"><wdo-name>ApprovalCriteriaWDO</wdo-name><display-name><localized-text><locale language="en">ApprovalCriteriaWDO</locale></localized-text></display-name><description><localized-text><locale language="en">Main WDO object used throughout the workflow.</locale></localized-text></description><attributes><attribute><attribute-name>plannedItemID</attribute-name><display-name><localized-text><locale language="en">plannedItemID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>approvalType</attribute-name><display-name><localized-text><locale language="en">approvalType</locale></localized-text></display-name><type>STRING</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>outstandingApprovals</attribute-name><display-name><localized-text><locale language="en">outstandingApprovals</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>plannedItemUserApprovalRejected</attribute-name><display-name><localized-text><locale language="en">plannedItemUserApprovalRejected</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>false</initial-value></attribute><attribute><attribute-name>caseID</attribute-name><display-name><localized-text><locale language="en">caseID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>eventType</attribute-name><display-name><localized-text><locale language="en">eventType</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>NoEvent</initial-value></attribute><attribute><attribute-name>plannedItemApprovalCriteriaID</attribute-name><display-name><localized-text><locale language="en">plannedItemApprovalCriteriaID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>userName</attribute-name><display-name><localized-text><locale language="en">userName</locale></localized-text></display-name><type>STRING</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>isProductPlannedItem</attribute-name><display-name><localized-text><locale language="en">isProductPlannedItem</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>false</initial-value></attribute><attribute><attribute-name>passedDeadline</attribute-name><display-name><localized-text><locale language="en">passedDeadline</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>false</initial-value></attribute></attributes></wdo><wdo is-list-wdo="false" initialize-attributes="false"><wdo-name>ApprovalConstantsWDO</wdo-name><display-name><localized-text><locale language="en">ApprovalConstantsWDO</locale></localized-text></display-name><attributes><attribute><attribute-name>PREAPPROVAL</attribute-name><display-name><localized-text><locale language="en">PREAPPROVAL</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>AW1</constant-value></attribute><attribute><attribute-name>POSTAPPROVAL</attribute-name><display-name><localized-text><locale language="en">POSTAPPROVAL</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>AW2</constant-value></attribute><attribute><attribute-name>FAILED_CRITERIA</attribute-name><display-name><localized-text><locale language="en">FAILED_CRITERIA</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>ServicePlans.FailedApprovalCriteria</constant-value></attribute><attribute><attribute-name>PASSED_CRITERIA</attribute-name><display-name><localized-text><locale language="en">PASSED_CRITERIA</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>ServicePlans.PassedApprovalCriteria</constant-value></attribute><attribute><attribute-name>TRUE</attribute-name><display-name><localized-text><locale language="en">TRUE</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>TRUE</constant-value></attribute></attributes></wdo></wdos><activities><start-process-activity id="1"><name><localized-text><locale language="en">Start Process Activity</locale></localized-text></name><description><localized-text><locale language="en">The start process activity</locale></localized-text></description><split type="none"><transition-id idref="19"/></split></start-process-activity><end-process-activity id="2"><name><localized-text><locale language="en">End Process Activity</locale></localized-text></name><description><localized-text><locale language="en">The end process activity</locale></localized-text></description><join type="xor"/></end-process-activity><automatic-activity id="5" category="AC1"><name><localized-text><locale language="en">Process Planned Item Approval Criteria</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="4"/><transition-id idref="15"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="processApprovalCriteriaForPlannedItem"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.workflow.wfl.struct.PlannedItemDetailsForApproval"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></base-type></field><field name="approvalType"><base-type type="STRING"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="approvalType"/></base-type></field><field name="caseID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="caseID"/></base-type></field></struct></formal-parameter></formal-parameters><return><struct><field name="dtls"><struct><field name="plannedItemApprovalCriteriaID"><base-type><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemApprovalCriteriaID"/></base-type></field></struct></field></struct></return></bpo-mapping></automatic-activity><automatic-activity id="8" category="AC1"><name><localized-text><locale language="en">Raise Planned Item User Approval Result Event</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="12"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="raisePIUserApprovalEvent"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.workflow.wfl.struct.PlannedItemUserApprovalResult"><field name="plannedItemUserApprovalRejected"><base-type type="BOOLEAN"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemUserApprovalRejected"/></base-type></field><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></base-type></field><field name="eventType"><base-type type="STRING"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="eventType"/></base-type></field></struct></formal-parameter></formal-parameters></bpo-mapping></automatic-activity><automatic-activity id="9" category="AC1"><name><localized-text><locale language="en">Update Planned Item Approval Status to Failed</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="9"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="processFailedApprovalCriteria"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.workflow.wfl.struct.PlannedItemIDAndApprovalCriteriaKey"><field name="key"><struct type="curam.serviceplans.sl.struct.PlannedItemIDAndApprovalCriteriaKey"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></base-type></field><field name="plannedItemApprovalCriteriaID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemApprovalCriteriaID"/></base-type></field></struct></field></struct></formal-parameter></formal-parameters></bpo-mapping></automatic-activity><automatic-activity id="12" category="AC1"><name><localized-text><locale language="en">Set Planned Item Approval Criteria Status</locale></localized-text></name><join type="xor"/><split type="none"><transition-id idref="26"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="setPIApprovalCriteriaStatus"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.workflow.wfl.struct.PIApprovalCriteriaStatusUpdateDtls"><field name="dtls"><struct type="curam.serviceplans.sl.struct.PIApprovalCriteriaStatusUpdateDtls"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></base-type></field><field name="approvalType"><base-type type="STRING"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="approvalType"/></base-type></field><field name="eventType"><base-type type="STRING"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="eventType"/></base-type></field></struct></field></struct></formal-parameter></formal-parameters><return><struct><field name="outstandingApprovals"><base-type><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="outstandingApprovals"/></base-type></field></struct></return></bpo-mapping></automatic-activity><automatic-activity id="13" category="AC1"><name><localized-text><locale language="en">Ensure Planned Item has Approval Criteria</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="20"/><transition-id idref="21"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="checkForApprovalCriteria"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.workflow.wfl.struct.PlannedItemDetailsForApproval"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></base-type></field><field name="approvalType"><base-type type="STRING"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="approvalType"/></base-type></field><field name="caseID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="caseID"/></base-type></field></struct></formal-parameter></formal-parameters><return><struct><field name="outstandingApprovals"><base-type><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="outstandingApprovals"/></base-type></field><field name="isPlannedItemAssociatedToProduct"><base-type><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="isProductPlannedItem"/></base-type></field></struct></return></bpo-mapping></automatic-activity><automatic-activity id="14" category="AC1"><name><localized-text><locale language="en">Set Planned Item Approval Processing Status 1</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="28"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="setApprovalProcessingStatusToReadyForApproval"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.facade.struct.PlannedItemIDKey"><field name="plannedItemIDKey"><struct type="curam.serviceplans.sl.struct.PlannedItemIDKey"><field name="plannedItemIDKey"><struct type="curam.serviceplans.sl.entity.struct.PlannedItemIDKey"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></base-type></field></struct></field></struct></field></struct></formal-parameter></formal-parameters></bpo-mapping></automatic-activity><automatic-activity id="18" category="AC1"><name><localized-text><locale language="en">Set Planned Item Approval Processing Status 2</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="30"/></split><bpo-mapping interface-name="curam.serviceplans.workflow.wfl.intf.PlannedItemApprovals" method-name="setApprovalProcessingStatusToReadyForApproval"><formal-parameters><formal-parameter index="0"><struct type="curam.serviceplans.facade.struct.PlannedItemIDKey"><field name="plannedItemIDKey"><struct type="curam.serviceplans.sl.struct.PlannedItemIDKey"><field name="plannedItemIDKey"><struct type="curam.serviceplans.sl.entity.struct.PlannedItemIDKey"><field name="plannedItemID"><base-type type="INT64"><wdo-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></base-type></field></struct></field></struct></field></struct></formal-parameter></formal-parameters></bpo-mapping></automatic-activity><subflow-activity id="7" category="AC1"><name><localized-text><locale language="en">Process Plan Item User Approval Check</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="8"/><transition-id idref="29"/></split><subflow workflow-process="PlannedItemUserApprovalCheck" synchronous="true"/><input-mappings><mapping><source-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/><target-attribute wdo-name="PlannedItemUserApprovalWDO" name="plannedItemID"/></mapping><mapping><source-attribute wdo-name="ApprovalCriteriaWDO" name="userName"/><target-attribute wdo-name="PlannedItemUserApprovalWDO" name="userName"/></mapping><mapping><source-attribute wdo-name="ApprovalCriteriaWDO" name="caseID"/><target-attribute wdo-name="PlannedItemUserApprovalWDO" name="caseID"/></mapping></input-mappings><output-mappings><mapping><source-attribute wdo-name="PlannedItemUserApprovalWDO" name="plannedItemUserApprovalRejected"/><target-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemUserApprovalRejected"/></mapping></output-mappings></subflow-activity><route-activity id="17" category="AC1"><name><localized-text><locale language="en">Join 4</locale></localized-text></name><join type="xor"/><split type="xor"><transition-id idref="22"/><transition-id idref="23"/></split></route-activity><route-activity id="16" category="AC1"><name><localized-text><locale language="en">Join 3</locale></localized-text></name><join type="xor"/><split type="none"><transition-id idref="27"/></split></route-activity><route-activity id="10" category="AC1"><name><localized-text><locale language="en">Join 2</locale></localized-text></name><join type="xor"/><split type="xor"><transition-id idref="6"/><transition-id idref="31"/><transition-id idref="13"/></split></route-activity><route-activity id="15" category="AC1"><name><localized-text><locale language="en">Join 1</locale></localized-text></name><join type="xor"/><split type="none"><transition-id idref="25"/></split></route-activity><loop-begin-activity id="3" category="AC1"><name><localized-text><locale language="en">startForEachPlannedItemApprovalCriteria [Begin]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="2"/></split><loop-type name="do-while"/><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.outstandingApprovals" operation="==" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/><expression id="2" data-item-lhs="ApprovalCriteriaWDO.eventType" operation="==" data-item-rhs="ApprovalConstantsWDO.PASSED_CRITERIA" conjunction="and" opening-brackets="1"/><expression id="3" data-item-lhs="ApprovalCriteriaWDO.approvalType" operation="==" data-item-rhs="ApprovalConstantsWDO.POSTAPPROVAL" conjunction="or" closing-brackets="1"/></condition><block-endpoint-ref activity-id="4"/></loop-begin-activity><loop-end-activity id="4" category="AC1"><name><localized-text><locale language="en">startForEachPlannedItemApprovalCriteria [End]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="24"/></split><block-endpoint-ref activity-id="3"/></loop-end-activity><event-wait-activity id="6" category="AC1"><name><localized-text><locale language="en">Wait for Approval Criteria to Complete</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="18"/><transition-id idref="17"/></split><event-wait wait-on-all-events="false"><events><event identifier="1" event-class="ServicePlans" event-type="PassedApprovalCriteria"><event-match-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></event><event identifier="2" event-class="ServicePlans" event-type="FailedApprovalCriteria"><event-match-attribute wdo-name="ApprovalCriteriaWDO" name="plannedItemID"/></event></events><event-output-mappings><event-type wdo-name="ApprovalCriteriaWDO" name="eventType"/></event-output-mappings><deadline complete-activity="true"><duration><seconds>604800</seconds></duration><deadline-output-mappings><duration-expired wdo-name="ApprovalCriteriaWDO" name="passedDeadline"/></deadline-output-mappings></deadline></event-wait></event-wait-activity></activities><transitions><transition id="2" from-activity-idref="3" to-activity-idref="5"/><transition id="4" from-activity-idref="5" to-activity-idref="6"><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.approvalType" operation="==" data-item-rhs="ApprovalConstantsWDO.PREAPPROVAL" conjunction="and"/></condition></transition><transition id="6" from-activity-idref="10" to-activity-idref="7"><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.approvalType" operation="==" data-item-rhs="ApprovalConstantsWDO.PREAPPROVAL" conjunction="and"/><expression id="2" data-item-lhs="ApprovalCriteriaWDO.isProductPlannedItem" operation="!=" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/><expression id="3" data-item-lhs="ApprovalCriteriaWDO.eventType" operation="!=" data-item-rhs="ApprovalConstantsWDO.FAILED_CRITERIA" conjunction="and"/><expression id="4" data-item-lhs="ApprovalCriteriaWDO.passedDeadline" operation="!=" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/></condition></transition><transition id="8" from-activity-idref="7" to-activity-idref="14"><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.plannedItemUserApprovalRejected" operation="!=" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/></condition></transition><transition id="9" from-activity-idref="9" to-activity-idref="15"/><transition id="12" from-activity-idref="8" to-activity-idref="2"/><transition id="13" from-activity-idref="10" to-activity-idref="17"/><transition id="15" from-activity-idref="5" to-activity-idref="12"/><transition id="17" from-activity-idref="6" to-activity-idref="15"/><transition id="18" from-activity-idref="6" to-activity-idref="9"><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.eventType" operation="==" data-item-rhs="ApprovalConstantsWDO.FAILED_CRITERIA" conjunction="and"/><expression id="2" data-item-lhs="ApprovalCriteriaWDO.passedDeadline" operation="==" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="or"/></condition></transition><transition id="19" from-activity-idref="1" to-activity-idref="13"/><transition id="20" from-activity-idref="13" to-activity-idref="3"><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.outstandingApprovals" operation="==" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/></condition></transition><transition id="21" from-activity-idref="13" to-activity-idref="10"/><transition id="22" from-activity-idref="17" to-activity-idref="8"><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.approvalType" operation="==" data-item-rhs="ApprovalConstantsWDO.PREAPPROVAL" conjunction="and"/></condition></transition><transition id="23" from-activity-idref="17" to-activity-idref="2"/><transition id="24" from-activity-idref="4" to-activity-idref="10"/><transition id="25" from-activity-idref="15" to-activity-idref="12"/><transition id="26" from-activity-idref="12" to-activity-idref="4"/><transition id="27" from-activity-idref="16" to-activity-idref="17"/><transition id="28" from-activity-idref="14" to-activity-idref="16"/><transition id="29" from-activity-idref="7" to-activity-idref="16"/><transition id="30" from-activity-idref="18" to-activity-idref="17"/><transition id="31" from-activity-idref="10" to-activity-idref="18"><condition><expression id="1" data-item-lhs="ApprovalCriteriaWDO.approvalType" operation="==" data-item-rhs="ApprovalConstantsWDO.PREAPPROVAL" conjunction="and"/><expression id="2" data-item-lhs="ApprovalCriteriaWDO.isProductPlannedItem" operation="==" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/><expression id="3" data-item-lhs="ApprovalCriteriaWDO.eventType" operation="!=" data-item-rhs="ApprovalConstantsWDO.FAILED_CRITERIA" conjunction="and"/><expression id="4" data-item-lhs="ApprovalCriteriaWDO.passedDeadline" operation="!=" data-item-rhs="ApprovalConstantsWDO.TRUE" conjunction="and"/></condition></transition></transitions></workflow-process>