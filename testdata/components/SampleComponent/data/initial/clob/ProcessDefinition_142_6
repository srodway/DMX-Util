<?xml version="1.0" encoding="UTF-8"?>
<workflow-process id="1126999418470785" process-version="1" language-version="1.0" released="true" category="PC1" createdBy="admin" creationDate="20090308T103912"><name>RemovePosition</name><process-display-name><localized-text><locale language="en">Remove Position</locale></localized-text></process-display-name><description><localized-text><locale language="en">This workflow process handles processing when an administrator chooses to delete a position from the organisation structure. If there are tasks or cases assigned to the deleted position, then a task is created for the organisation's lead user to request the workload be reassigned. Note that this workflow process is not being called by any out of the box processing. </locale></localized-text></description><enactment-mappings><mapping><source-attribute struct-name="curam.core.sl.entity.struct.PositionName" name="name"/><target-attribute wdo-name="RemovePositionWDO" name="positionName"/></mapping><mapping><source-attribute struct-name="curam.core.sl.struct.CancelPositionByWorkFlowKey" name="organisationStructureID"/><target-attribute wdo-name="RemovePositionWDO" name="organisationStructureID"/></mapping><mapping><source-attribute struct-name="curam.core.sl.struct.CancelPositionByWorkFlowKey" name="cancelPositionKey.positionID"/><target-attribute wdo-name="RemovePositionWDO" name="positionID"/></mapping><mapping><source-attribute struct-name="curam.core.sl.struct.CancelPositionByWorkFlowKey" name="organisationUnitID"/><target-attribute wdo-name="RemovePositionWDO" name="organisationUnitID"/></mapping></enactment-mappings><wdos><wdo is-list-wdo="false" initialize-attributes="false"><wdo-name>RemovePositionWDO</wdo-name><display-name><localized-text><locale language="en">RemovePositionWDO</locale></localized-text></display-name><attributes><attribute><attribute-name>isPositionDeleted</attribute-name><display-name><localized-text><locale language="en">isPositionDeleted</locale></localized-text></display-name><type>BOOLEAN</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>false</initial-value></attribute><attribute><attribute-name>positionName</attribute-name><display-name><localized-text><locale language="en">positionName</locale></localized-text></display-name><type>STRING</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>adminUser</attribute-name><display-name><localized-text><locale language="en">adminUser</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><initial-value>admin</initial-value></attribute><attribute><attribute-name>supervisorUser</attribute-name><display-name><localized-text><locale language="en">supervisorUser</locale></localized-text></display-name><type>STRING</type><required-at-enactment>false</required-at-enactment><process-output>false</process-output><constant-value>supervisor</constant-value></attribute><attribute><attribute-name>organisationStructureID</attribute-name><display-name><localized-text><locale language="en">organisationStructureID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>positionID</attribute-name><display-name><localized-text><locale language="en">positionID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute><attribute><attribute-name>organisationUnitID</attribute-name><display-name><localized-text><locale language="en">organisationUnitID</locale></localized-text></display-name><type>INT64</type><required-at-enactment>true</required-at-enactment><process-output>false</process-output></attribute></attributes></wdo></wdos><activities><start-process-activity id="1"><name><localized-text><locale language="en">Start Process Activity</locale></localized-text></name><description><localized-text><locale language="en">The start process activity</locale></localized-text></description><split type="none"><transition-id idref="1"/></split></start-process-activity><end-process-activity id="2"><name><localized-text><locale language="en">End Process Activity</locale></localized-text></name><description><localized-text><locale language="en">The end process activity</locale></localized-text></description><join type="none"/></end-process-activity><automatic-activity id="3" category="AC1"><name><localized-text><locale language="en">Remove Position</locale></localized-text></name><join type="none"/><split type="xor"><transition-id idref="3"/><transition-id idref="10"/></split><bpo-mapping interface-name="curam.core.sl.intf.Position" method-name="cancelPositionInWF"><formal-parameters><formal-parameter index="0"><struct type="curam.core.sl.struct.CancelPositionByWorkFlowKey"><field name="organisationStructureID"><base-type type="INT64"><wdo-attribute wdo-name="RemovePositionWDO" name="organisationStructureID"/></base-type></field><field name="organisationUnitID"><base-type type="INT64"><wdo-attribute wdo-name="RemovePositionWDO" name="organisationUnitID"/></base-type></field><field name="cancelPositionKey"><struct type="curam.core.sl.entity.struct.CancelPositionKey"><field name="positionID"><base-type type="INT64"><wdo-attribute wdo-name="RemovePositionWDO" name="positionID"/></base-type></field></struct></field></struct></formal-parameter></formal-parameters><return><struct><field name="isPositionDeleted"><base-type><wdo-attribute wdo-name="RemovePositionWDO" name="isPositionDeleted"/></base-type></field></struct></return></bpo-mapping></automatic-activity><manual-activity id="4" category="AC1"><name><localized-text><locale language="en">Reassign User Tasks &amp; Cases</locale></localized-text></name><notification delivery-mechanism="DM1"><subject><message><message-text><localized-text><locale language="en">The Position %1s has at least one case or task.</locale></localized-text></message-text><message-parameters><wdo-attribute wdo-name="RemovePositionWDO" name="positionName"/></message-parameters></message></subject><body><message><message-text><localized-text><locale language="en">%1s could not be removed because task(s) and/or case(s) are assigned to the Position. A Task has been created and assigned to the Organization Unit's Supervisor to request the workload be reassigned.</locale></localized-text></message-text><message-parameters><wdo-attribute wdo-name="RemovePositionWDO" name="positionName"/></message-parameters></message></body><allocation-strategy type="function" identifier="curam.core.sl.intf.NotificationAllocationFunction.defaultStrategy"><function-mappings><formal-parameters><formal-parameter index="0"><base-type type="STRING"><wdo-attribute wdo-name="RemovePositionWDO" name="adminUser"/></base-type></formal-parameter></formal-parameters></function-mappings></allocation-strategy></notification><join type="none"/><split type="none"><transition-id idref="9"/></split><task><message><message-text><localized-text><locale language="en">Reallocate all the tasks and Cases assigned to position %1s as it is marked for removal.</locale></localized-text></message-text><message-parameters><wdo-attribute wdo-name="RemovePositionWDO" name="positionName"/></message-parameters></message><actions><action page-id="Organization_closeRemovePositionTask" principal-action="true" open-modal="true"><message><message-text><localized-text><locale language="en">Confirm Workload Reallocation</locale></localized-text></message-text></message><link-parameter name="positionName"><wdo-attribute wdo-name="RemovePositionWDO" name="positionName"/></link-parameter><link-parameter name="taskID"><wdo-attribute wdo-name="Context_Task" name="taskID"/></link-parameter></action></actions><allow-deadline-override>false</allow-deadline-override><allow-task-forwarding>true</allow-task-forwarding></task><allocation-strategy type="function" identifier="curam.core.sl.intf.NotificationAllocationFunction.orgUnitSupervisorStrategy"><function-mappings><formal-parameters><formal-parameter index="0"><base-type type="INT64"><wdo-attribute wdo-name="RemovePositionWDO" name="organisationUnitID"/></base-type></formal-parameter><formal-parameter index="1"><base-type type="INT64"><wdo-attribute wdo-name="RemovePositionWDO" name="organisationStructureID"/></base-type></formal-parameter></formal-parameters></function-mappings></allocation-strategy><event-wait wait-on-all-events="false"><events><event identifier="1" event-class="TASK" event-type="CLOSED"><event-match-attribute wdo-name="Context_Task" name="taskID"/></event></events></event-wait></manual-activity><route-activity id="5"><name><localized-text><locale language="en">Route 1</locale></localized-text></name><join type="xor"/><split type="none"><transition-id idref="7"/></split></route-activity><route-activity id="9" category="AC1"><name><localized-text><locale language="en">Route with delete notification</locale></localized-text></name><notification delivery-mechanism="DM1"><subject><message><message-text><localized-text><locale language="en">The Position %1s has been removed successfully.</locale></localized-text></message-text><message-parameters><wdo-attribute wdo-name="RemovePositionWDO" name="positionName"/></message-parameters></message></subject><body><message><message-text><localized-text><locale language="en">The system successfully completed the process of removing Position %1s.</locale></localized-text></message-text><message-parameters><wdo-attribute wdo-name="RemovePositionWDO" name="positionName"/></message-parameters></message></body><allocation-strategy type="function" identifier="curam.core.sl.intf.NotificationAllocationFunction.defaultStrategy"><function-mappings><formal-parameters><formal-parameter index="0"><base-type type="STRING"><wdo-attribute wdo-name="RemovePositionWDO" name="adminUser"/></base-type></formal-parameter></formal-parameters></function-mappings></allocation-strategy></notification><join type="none"/><split type="none"><transition-id idref="11"/></split></route-activity><loop-begin-activity id="7"><name><localized-text><locale language="en">Remove Position Loop [Begin]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="2"/></split><loop-type name="while"/><condition><expression id="1" data-item-lhs="RemovePositionWDO.isPositionDeleted" operation="==" data-item-rhs="false" conjunction="and"/></condition><block-endpoint-ref activity-id="8"/></loop-begin-activity><loop-end-activity id="8"><name><localized-text><locale language="en">Remove Position Loop [End]</locale></localized-text></name><join type="none"/><split type="none"><transition-id idref="8"/></split><block-endpoint-ref activity-id="7"/></loop-end-activity></activities><transitions><transition id="1" from-activity-idref="1" to-activity-idref="7"/><transition id="2" from-activity-idref="7" to-activity-idref="3"/><transition id="3" from-activity-idref="3" to-activity-idref="4"><condition><expression id="1" data-item-lhs="RemovePositionWDO.isPositionDeleted" operation="==" data-item-rhs="false" conjunction="and"/></condition></transition><transition id="7" from-activity-idref="5" to-activity-idref="8"/><transition id="8" from-activity-idref="8" to-activity-idref="2"/><transition id="9" from-activity-idref="4" to-activity-idref="5"/><transition id="10" from-activity-idref="3" to-activity-idref="9"/><transition id="11" from-activity-idref="9" to-activity-idref="5"/></transitions></workflow-process>